
<!-- saved from url=(0050)http://www.ibiblio.org/e-notes/Splines/bezier.html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
 <title>Bezier spline curves</title>

<script src="./Bezier spline curves_files/bezier.js" type="text/javascript"></script><style type="text/css"></style>
<style type="text/css">
  H1{ font-size: 120%; color: green}
  H2{ font-size: 100%; color: green}
</style>
</head>
<body>

<h1>Bezier spline curves</h1>

<h2>Linear Bezier spline</h2>

Linear Bezier spline is obtained by <i>linear interpolation</i> between
two <i>control points</i> <i><b>P</b><sub>0</sub> , <b>P</b><sub>1</sub></i>
<br>&nbsp; &nbsp; <i><b>P</b>(t) = (1-t)<b>P</b><sub>0</sub> +
t<b>P</b><sub>1</sub> , &nbsp; &nbsp; 0 &#8804; t &#8804; 1</i>

<br><img width="30%" height="auto" src="./Bezier spline curves_files/Bezier2.gif" alt="linear interpolation">
<canvas id="c1" width="443" height="443"></canvas>
<canvas id="c12" width="443" height="443"></canvas>
<script type="text/javascript">
  var b1 = new Bezier("c1", "c12", .3, [ .1, .9], [.1, .9]);
</script>
<br><i>Interactive Bezier spline</i> &nbsp; 
Use finger or mouse to move nearest control point (a small blue square).
In the right window you see basis polynomials of the linear Bezier spline.
The red line is <i>(1-t)</i> and the green one is <i>t</i>.
Images are fitted to your browser window
(sorry if your browser doesn't support HTML5).

<h2>Quadratic Bezier spline</h2>

Quadratic Bezier spline is obtained by <i>deCasteljau algorithm</i> as
a linear interpolation between linear interpolation between control points
<i><b>P</b><sub>0</sub> , <b>P</b><sub>1</sub> , <b>P</b><sub>2</sub></i>

<br>&nbsp; &nbsp; <i><b>P</b><sub>0</sub><sup>1</sup> =
(1-t)<b>P</b><sub>0</sub> + t<b>P</b><sub>1</sub> ,
&nbsp; &nbsp; <b>P</b><sub>1</sub><sup>1</sup> =
(1-t)<b>P</b><sub>1</sub> + t<b>P</b><sub>2</sub> ,
<br>&nbsp; &nbsp; <b>P</b>(t) = (1-t)<b>P</b><sub>0</sub><sup>1</sup> +
t<b>P</b><sub>1</sub><sup>1</sup> = 
(1-t)[(1-t)<b>P</b><sub>0</sub> + t<b>P</b><sub>1 </sub>] +
t[(1-t)<b>P</b><sub>1</sub> + t<b>P</b><sub>2 </sub>] =
 (1-t)<sup>2</sup><b>P</b><sub>0</sub> +
 2(1-t)t<b>P</b><sub>1</sub> + t<sup>2</sup><b>P</b><sub>2</sub> ,

</i><p><i>&nbsp; &nbsp; <b>P</b>(t) = &#8721;<sub>i=0,2</sub>
B<sub>i</sub><sup>2</sup>(t) <b>P</b><sub>i </sub>,
&nbsp; &nbsp; B<sub>i</sub><sup>n</sup>(t) = C<sub>n</sub><sup>i</sup>
t<sup>i</sup>(1-t)<sup>n-i</sup> ,
&nbsp; &nbsp; C<sub>n</sub><sup>i</sup> = n! / i!(n-i)!</i>
<br>where <i>B<sub>i</sub><sup>n</sup>(t)</i> are Bernstein polynomials.
To the right you see basis polynomials <i>B<sub>0</sub><sup>2</sup>(t) ,
B<sub>1</sub><sup>2</sup>(t) , B<sub>2</sub><sup>2</sup>(t)</i> in the red,
green, blue, ... order.

<br><img width="30%" height="auto" src="./Bezier spline curves_files/Bezier3.gif" alt="deCasteljau algorithm">
<canvas id="c2" width="443" height="443"></canvas>
<canvas id="c22" width="443" height="443"></canvas>
<script type="text/javascript">
  var b2 = new Bezier("c2", "c22", .3, [ .1, .5, .9], [.1, .9, .1]);
</script>

<br>By construction Bezier spline goes through its terminal control points
(<i><b>P</b><sub>0</sub> , <b>P</b><sub>2 </sub></i> here)
and is tangent to the first and last segments of the control polygon.
Note that <i><b>P</b>(t)</i> subdivides the curve in two quadratic splines
(see Fig.2). The new curves match the original in position, although they
differ in parameterization. Points
<i><b>P</b><sub>0</sub> , <b>P</b><sub>0</sub><sup>1</sup> , <b>P</b>(t)</i>
and <i><b>P</b>(t) , <b>P</b><sub>1</sub><sup>1</sup> , <b>P</b><sub>1</sub></i>
are control points of the new small splines .

</p><h2>Cubic Bezier spline</h2>

In a similar way one can use deCasteljau algorithm to
interpolate a curve between <i>(n+1)</i> control points
<i><b>P</b><sub>0</sub> , <b>P</b><sub>1</sub> ... <b>P</b><sub>n</sub></i> .
E.g. for <i>n = 3</i> we get cubic Bezier spline
<br><img width="30%" height="auto" src="./Bezier spline curves_files/Bezier4.gif" alt="deCasteljau algorithm">
<canvas id="c3" width="443" height="443"></canvas>
<canvas id="c32" width="443" height="443"></canvas>
<script type="text/javascript">
  var b3 = new Bezier("c3", "c32", .3, [ .5, .1, .9, .9], [.1, .9, .9, .1]);
</script>

<br>Points <i><b>P</b><sub>0</sub> , <b>P</b><sub>0</sub><sup>1</sup> ,
<b>P</b><sub>0</sub><sup>2</sup> , <b>P</b>(t)</i>
and <i><b>P</b>(t) , <b>P</b><sub>1</sub><sup>2</sup> ,
<b>P</b><sub>2</sub><sup>1</sup> , <b>P</b><sub>3</sub></i>
are control points of new small splines again.
The control points of the two new curves appear along the sides of
the systolic array (see Fig.4 below).

<h2>How to plot Bezier spline</h2>

DeCasteljau iterations
<br>&nbsp; &nbsp; <i><b>P</b><sub>i</sub><sup>j</sup> =
(1-t)<b>P</b><sub>i</sub><sup>j-1</sup> + t<b>P</b><sub>i+1</sub><sup>j-1</sup>,
&nbsp; &nbsp; j = 1, n &nbsp; &nbsp; i = 0, n-j</i>
<br>for <i>n = 3</i> are shown on the scheme in Fig.4

<br><img width="23%" height="auto" alt="Fig.4" src="./Bezier spline curves_files/Fig4.gif">
&nbsp; <img width="25%" height="auto" alt="Fig.5" src="./Bezier spline curves_files/Fig5.gif">
&nbsp; &nbsp; <img width="34%" height="auto" alt="Fig.5a" src="./Bezier spline curves_files/Fig5a.gif">

<br>This algorithm is programmed as (see
<a href="./Bezier spline curves_files/bezier.js">bezier.js</a> too)
<pre>   for (j = N-1; j &gt; 0; j--)
    for (i = 0; i &lt; j; i++){
      Px[i] = (1-t)*Px[i] + t*Px[i+1];
      Py[i] = (1-t)*Py[i] + t*Py[i+1];
    }
</pre>
where <i>N = n+1</i> is number of control points.
<br>To obtain basis polynomials recurrence relations can be used
<br><i>&nbsp; &nbsp; B<sub>0</sub><sup>0</sup>(t) = 1,
<br>&nbsp; &nbsp; B<sub>i</sub><sup>n</sup>(t) =
(1-t)B<sub>i</sub><sup>n-1</sup>(t) + tB<sub>i-1</sub><sup>n-1</sup>(t),</i>
<br>where <i>B<sub>r</sub><sup>s</sup> = 0</i> when <i>r &lt; 0</i> or
<i>r &gt; s</i>.

<br>This algorithm is shown on Fig.5a . It is programmed as
<pre>   B[1] = 1;
   for (j = 1; j &lt; N; j++)
    for (i = j+1; i &gt; 0; i--)
      B[i] = (1-t)*B[i] + t*B[i-1];
</pre>
here <i>B[0] = 0</i> is added for convenience, therefore <i>i -&gt; i+1</i>.
Basis functions can be obtained too without "zeros" (see Fig.5)
<pre>   B[0] = 1;
   for (j = 0; j &lt; n; j++)
    for (i = j; i =&gt; 0; i--){
      B[i+1] += t*B[i];
      B[i] = (1-t)*B[i];
    }
</pre>

Bezier spline of degree <i>n = 7</i>
<br><canvas id="c4" width="591" height="591"></canvas>
<canvas id="c42" width="591" height="591"></canvas>
<script type="text/javascript">
  var c4 = new Bezier("c4", "c42", .4, [ .1, .1, .8, .8, .5, .3, .5, .9],
    [.1, .8, .9, .2, .1, .5, .6, .3]);
</script>

<br>The general expression for the Bezier spline of degree <i>n</i>
(order <i>n+1</i>) is
<br>&nbsp; &nbsp; <i><b>P</b>(t) = &#8721;<sub>i=0,n</sub>
B<sub>i</sub><sup>n</sup>(t) <b>P</b><sub>i </sub></i>.

<br>Further you can read <a href="http://www.ibiblio.org/e-notes/Splines/more.html">More Bezier splines Math</a> or
go directly to <a href="http://www.ibiblio.org/e-notes/Splines/lagrange.html">Interpolating Lagrange curve</a>.

<hr><a href="http://www.ibiblio.org/e-notes/Splines/Intro.htm">Contents</a>
&nbsp; Next: <a href="http://www.ibiblio.org/e-notes/Splines/more.html">More Bezier splines Math</a>
<br><i>updated</i> 7 August 2001


</body></html>